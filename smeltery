local smeltery = peripheral.find("crafters_smeltery")
local chest = peripheral.wrap("right")
local mon = peripheral.find("monitor")
local net = peripheral.find("modem")

monitor = "none"

function compare(slot1, slot2)
  if unexpected_condition then error() end
  if slot1 == slot2 then
    return true
  else
    return false
  end
end

function detectDevice(DeviceName)
  DeviceSide="none"
  for k,v in pairs(redstone.getSides()) do
   if peripheral.getType(v)==DeviceName then
     DeviceSide = v
     break
   end
  end
  return(DeviceSide)
end

function checkdrain()
  tank = smeltery.getInfo()
  if tank["contents"] == nil then
    return true
  else
    return false
  end
end

function monitorloop()
  tank = smeltery.getInfo()
  for i=1,9 do
    table.insert(islot, smeltery.getStackInSlot(i))
  end
  for i=0,#islot do
    if islot[i] ~= nil then
      smelting = islot[i].display_name
    end
  end
  tank = smeltery.getInfo()
  if tank["contents"] ~= nil then
    draining = tank["contents"]
  else
    draining = "nothing"
  end
  if monitor ~= "none" then
    mon.clear()
    mon.setCursorPos(1,2)s
    mon.write("Smelting:")
    mon.setCursorPos(1,3)
    mon.write(smelting)
    mon.setCursorPos(1,4)
    mon.write("Draining:")
    mon.setCursorPos(1,5)
    mon.write()
  end
end

while true do
  MonitorSide = detectDevice("monitor")
  SmelterySlot1 = smeltery.getStackInSlot(1)
  Table = chest.getAllStacks()
  ChestSize = chest.getInventorySize()
  ChestInv = {}
  ChestSlot1 = chest.getStackInSlot(1)
  if checkdrain() == true then
    for i=1,ChestSize do
      if SmelterySlot1 == nil and chest.getStackInSlot(i) ~= nil then
        chest.pushItem("east", i, 64, 1)
      elseif SmelterySlot1 == nil and chest.getStackInSlot(i) == nil then
        print("Smeltery is Empty!  The Dwarves are being lazy!")
      else
        if compare(SmelterySlot1, chest.getStackInSlot(i)) then
          print("Let's get to work!")
          chest.pushItem("east", i, 1, 1)
          return
        else
          print("Let's check the next slot!")
        end
      end
    end
  else os.sleep(60)
  end
  os.sleep(120)
end
